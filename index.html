<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  
  <!-- æ€§èƒ½ä¼˜åŒ– -->
  <meta name="description" content="OTISç”µæ¢¯åŠ©æ‰‹å°å¥¥ - ä¸“ä¸šçš„ç”µæ¢¯æ™ºèƒ½åŠ©æ‰‹ï¼Œæä¾›å®æ—¶å’¨è¯¢å’ŒæœåŠ¡">
  <meta name="keywords" content="OTIS,ç”µæ¢¯,æ™ºèƒ½åŠ©æ‰‹,PWA,ç§»åŠ¨ç«¯">
  
  <!-- é¢„åŠ è½½å…³é”®èµ„æº -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="dns-prefetch" href="http://47.117.87.105">
  <title>OTISç”µæ¢¯åŠ©æ‰‹å°å¥¥</title>
  <link rel="stylesheet" href="/styles.css">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#1e88e5">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="å°å¥¥åŠ©æ‰‹">
  <link rel="apple-touch-icon" href="icons/icon-192X192.png">
  
  <!-- PWAå›¾æ ‡ -->
  <link rel="icon" type="image/png" sizes="72x72" href="icons/icon-72X72.png">
  <link rel="icon" type="image/png" sizes="96x96" href="icons/icon-96X96.png">
  <link rel="icon" type="image/png" sizes="128x128" href="icons/icon-128X128.png">
  <link rel="icon" type="image/png" sizes="144x144" href="icons/icon-144X144.png">
  <link rel="icon" type="image/png" sizes="152x152" href="icons/icon-152X152.png">
  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192X192.png">
  <link rel="icon" type="image/png" sizes="384x384" href="icons/icon-384X384.png">
  <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512X512.png">
  
  <!-- é¢„åŠ è½½å…³é”®èµ„æº -->
  <link rel="preload" href="/styles.css" as="style">
  <link rel="preload" href="/app.js" as="script">
  
  <!-- æ·»åŠ Googleå­—ä½“ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- æ·»åŠ Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
  <div class="app-container">
    <!-- ç™»å½•é¡µé¢ -->
    <div id="login-page" class="page active">
      <div class="login-container">
        <div class="login-card">
          <img src="icons/icon-192x192.png" alt="OTIS Logo" class="login-logo">
          <h1 class="login-title">OTISç”µæ¢¯åŠ©æ‰‹å°å¥¥</h1>
          <p class="login-subtitle">ä¸“ä¸šçš„ç”µæ¢¯æ™ºèƒ½åŠ©æ‰‹ï¼Œä¸ºæ‚¨æä¾›è´´å¿ƒæœåŠ¡</p>
          
          <div class="form-group">
            <label class="form-label" for="user-id">é€‰æ‹©æ‚¨çš„èº«ä»½</label>
            <select id="user-id" class="form-control">
              <option value="">è¯·é€‰æ‹©èº«ä»½</option>
              <option value="admin_001">ğŸ”§ ç³»ç»Ÿç®¡ç†å‘˜</option>
              <option value="vip_001">â­ VIPç”¨æˆ·</option>
              <option value="maintenance_001">ğŸ› ï¸ ç»´ä¿äººå‘˜</option>
              <option value="property_001">ğŸ¢ ç‰©ä¸šäººå‘˜</option>
              <option value="user_001">ğŸ‘¤ æ™®é€šç”¨æˆ·</option>
            </select>
          </div>
          
          <button id="login-btn" class="btn btn-primary">
            <span class="material-icons">login</span>
            ç«‹å³ç™»å½•
          </button>
          <div id="login-status" class="status-message hidden"></div>
        </div>
      </div>
    </div>

    <!-- ä¸»é¡µé¢ -->
    <div id="main-page" class="page">
      <header class="app-header">
        <div class="header-title">å°å¥¥åŠ©æ‰‹</div>
        <div class="user-info">
          <div class="user-avatar" id="user-avatar"></div>
          <span id="user-name"></span>
          <button id="logout-btn" class="btn btn-small btn-secondary">
            <span class="material-icons">logout</span>
          </button>
        </div>
      </header>

      <div class="main-content">
        <!-- ä¼šè¯ç®¡ç† -->
        <div class="sessions-panel" id="sessions-panel">
          <div class="panel-header">
            <h2 class="panel-title">ä¼šè¯åˆ—è¡¨</h2>
            <button id="new-session-btn" class="btn btn-primary btn-small">
              <span class="material-icons">add</span>
              æ–°å»º
            </button>
          </div>

          <!-- æœç´¢æ¡† -->
          <div class="search-container">
            <div class="search-input-wrapper">
              <span class="material-icons search-icon">search</span>
              <input type="text" id="session-search" class="search-input" placeholder="æœç´¢ä¼šè¯...">
              <button id="clear-search" class="clear-search-btn hidden">
                <span class="material-icons">clear</span>
              </button>
            </div>
          </div>

          <div id="sessions-list" class="sessions-list">
            <div class="empty-state">
              <div class="empty-state-icon material-icons">chat</div>
              <div class="empty-state-title">æš‚æ— ä¼šè¯</div>
              <div class="empty-state-subtitle">ç‚¹å‡»å³ä¸Šè§’æŒ‰é’®åˆ›å»ºæ–°ä¼šè¯</div>
            </div>
          </div>
        </div>

        <!-- èŠå¤©åŒºåŸŸ -->
        <div class="chat-panel" id="chat-panel">
          <div id="no-session-message" class="no-session-message">
            <div class="no-session-icon material-icons">chat_bubble_outline</div>
            <div class="no-session-title">å¼€å§‹å¯¹è¯</div>
            <div class="no-session-subtitle">é€‰æ‹©ä¸€ä¸ªä¼šè¯æˆ–åˆ›å»ºæ–°ä¼šè¯å¼€å§‹èŠå¤©</div>
          </div>
          
          <div id="chat-container" class="chat-container hidden">
            <div class="chat-header">
              <div class="chat-header-left">
                <div class="chat-avatar">
                  <span class="material-icons">smart_toy</span>
                </div>
                <div>
                  <div class="chat-title" id="current-session-title">å°å¥¥åŠ©æ‰‹</div>
                  <div class="chat-subtitle">åœ¨çº¿ä¸ºæ‚¨æœåŠ¡</div>
                </div>
              </div>
              <div class="chat-actions">
                <button id="back-btn" class="btn btn-small btn-secondary hidden">
                  <span class="material-icons">arrow_back</span>
                </button>
              </div>
            </div>
            
            <div id="messages-container" class="messages-container">
              <!-- æ¶ˆæ¯å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <div class="message-input-container">
              <div class="message-input-wrapper">
                <textarea 
                  id="message-input" 
                  placeholder="è¾“å…¥æ¶ˆæ¯..." 
                  class="message-input"
                  rows="1"
                ></textarea>
              </div>
              <div class="input-actions">
                <button id="send-message-btn" class="input-action">
                  <span class="material-icons">send</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ç§»åŠ¨ç«¯åº•éƒ¨å¯¼èˆª -->
    <nav class="bottom-nav">
      <div class="bottom-nav-items">
        <a href="#" class="bottom-nav-item active" id="nav-sessions">
          <span class="material-icons bottom-nav-icon">chat</span>
          <span>ä¼šè¯</span>
        </a>
        <a href="#" class="bottom-nav-item" id="nav-new-session">
          <span class="material-icons bottom-nav-icon">add_circle</span>
          <span>æ–°å»º</span>
        </a>
        <a href="#" class="bottom-nav-item" id="nav-profile">
          <span class="material-icons bottom-nav-icon">person</span>
          <span>æˆ‘çš„</span>
        </a>
      </div>
    </nav>
  </div>

  <script src="/api-client.js"></script>
  <script src="/chat-history.js"></script>
  <script src="/app.js"></script>

  <!-- å¼€å‘ç¯å¢ƒæµ‹è¯•è„šæœ¬ -->
  <script>
    if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
      const testScript = document.createElement('script');
      testScript.src = 'test-functions.js';
      document.head.appendChild(testScript);
    }
  </script>
</body>
</html>